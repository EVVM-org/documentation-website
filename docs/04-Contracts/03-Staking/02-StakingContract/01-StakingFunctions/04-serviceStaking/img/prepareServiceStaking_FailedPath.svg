<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="651px" preserveAspectRatio="none" style="width:868px;height:651px;background:#FFFFFF;" version="1.1" viewBox="0 0 868 651" width="868px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="320" x="275.25" y="27.9951">prepareServiceStaking Transaction Flow</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="227" x="321.75" y="44.292">(Failed Path - Error Handling)</text><rect fill="#FFD700" height="470.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="369.5" y="121.0234"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="674.5" y="311.7578"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="674.5" y="385.1563"/><rect fill="#F5B7B1" height="421.3281" style="stroke:#000000;stroke-width:1.5;" width="851.5" x="10" y="178.1563"/><rect fill="#FFFFFF" height="338.7969" style="stroke:none;stroke-width:1.0;" width="851.5" x="10" y="260.6875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83" x2="83" y1="89.8906" y2="616.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="374" x2="374" y1="89.8906" y2="616.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="679" x2="679" y1="89.8906" y2="616.4844"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="20" y="58.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="27" y="78.5889">Service Contract</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="20" y="615.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="27" y="635.4795">Service Contract</text><rect fill="#FFD700" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="342" y="58.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="349" y="78.5889">Staking</text><rect fill="#FFD700" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="342" y="615.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="349" y="635.4795">Staking</text><rect fill="#00EE20" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="653" y="58.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="660" y="78.5889">EVVM</text><rect fill="#00EE20" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="653" y="615.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="660" y="635.4795">EVVM</text><rect fill="#FFD700" height="470.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="369.5" y="121.0234"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="674.5" y="311.7578"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="674.5" y="385.1563"/><polygon fill="#181818" points="357.5,117.0234,367.5,121.0234,357.5,125.0234,361.5,121.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.5" x2="363.5" y1="121.0234" y2="121.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="90.5" y="115.9575">prepareServiceStaking(amountOfStaking)</text><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="421.5" y1="150.1563" y2="150.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="421.5" x2="421.5" y1="150.1563" y2="163.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="380.5" x2="421.5" y1="163.1563" y2="163.1563"/><polygon fill="#181818" points="390.5,159.1563,380.5,163.1563,390.5,167.1563,386.5,163.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="386.5" y="145.0903">onlyCA modifier check</text><path d="M10,178.1563 L74,178.1563 L74,185.2891 L64,195.2891 L10,195.2891 L10,178.1563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="421.3281" style="stroke:#000000;stroke-width:1.5;" width="851.5" x="10" y="178.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="191.2231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="197" x="89" y="190.3667">[Caller is not a contract (EOA)]</text><line style="stroke:#181818;stroke-width:2.0;" x1="90.5" x2="100.5" y1="229.5547" y2="239.5547"/><line style="stroke:#181818;stroke-width:2.0;" x1="90.5" x2="100.5" y1="239.5547" y2="229.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="95.5" x2="368.5" y1="234.5547" y2="234.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="100.5" y="229.4888">Revert with AddressIsNotAService</text><path d="M384,200.2891 L384,255.2891 L608,255.2891 L608,210.2891 L598,200.2891 L384,200.2891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M598,200.2891 L598,210.2891 L608,210.2891 L598,200.2891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="390" y="217.356">SECURITY: Only smart contracts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="390" y="232.4888">can perform service staking</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="390" y="247.6216">Protects against misuse</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="861.5" y1="261.6875" y2="261.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132" x="15" y="271.8979">[Caller is a contract]</text><polygon fill="#181818" points="662.5,307.7578,672.5,311.7578,662.5,315.7578,666.5,311.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="668.5" y1="311.7578" y2="311.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="386.5" y="291.5591">Query service balance</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="386.5" y="306.6919">balances[service][PRINCIPAL_TOKEN]</text><polygon fill="#181818" points="390.5,336.8906,380.5,340.8906,390.5,344.8906,386.5,340.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="384.5" x2="678.5" y1="340.8906" y2="340.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="396.5" y="335.8247">amountServiceBeforeStaking</text><polygon fill="#181818" points="662.5,381.1563,672.5,385.1563,662.5,389.1563,666.5,385.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="668.5" y1="385.1563" y2="385.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="386.5" y="364.9575">Query staking contract balance</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="386.5" y="380.0903">balances[address(this)][PRINCIPAL_TOKEN]</text><polygon fill="#181818" points="390.5,410.2891,380.5,414.2891,390.5,418.2891,386.5,414.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="384.5" x2="678.5" y1="414.2891" y2="414.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="396.5" y="409.2231">amountStakingBeforeStaking</text><line style="stroke:#181818;stroke-width:1.0;" x1="379.5" x2="421.5" y1="549.3516" y2="549.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="421.5" x2="421.5" y1="549.3516" y2="562.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="380.5" x2="421.5" y1="562.3516" y2="562.3516"/><polygon fill="#181818" points="390.5,558.3516,380.5,562.3516,390.5,566.3516,386.5,562.3516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="386.5" y="438.356">Store serviceStakingData:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="386.5" y="453.4888">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="394.5" y="468.6216">service: msg.sender,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="394.5" y="483.7544">timestamp: block.timestamp,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="394.5" y="498.8872">amountOfStaking: amountOfStaking,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="394.5" y="514.02">amountServiceBeforeStaking,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="394.5" y="529.1528">amountStakingBeforeStaking</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="386.5" y="544.2856">}</text><path d="M642,468.6211 L642,523.6211 L841,523.6211 L841,478.6211 L831,468.6211 L642,468.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M831,468.6211 L831,478.6211 L841,478.6211 L831,468.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="648" y="485.688">WARNING: If next steps fail,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="648" y="500.8208">this data becomes stale</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="648" y="515.9536">Always complete in same tx</text><polygon fill="#181818" points="94.5,587.4844,84.5,591.4844,94.5,595.4844,90.5,591.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="88.5" x2="373.5" y1="591.4844" y2="591.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="100.5" y="586.4185">Preparation completed</text><!--SRC=[hLHTQzim57tNhxWqBmaiNJOO1LCARkfqOLkI9Lt7gCjGx9j4H9QCf7nH-jztRIjkaXR6O6_M_JZtddCaNrgtatZ5KfsiCbGEdXZ0DK-MjqQlLDhLKXlOB8H3zimkt_jgbdFZH29oJXrd4pHhaI1qjNA69-uCk0LR1Kyg7LyADQyAgczez7et5vtESM5qV_-jhCBrEeD6fnD57pkCEU4aGcwGYj6FzPXmPxYoD5re1JsfDx5gzhYGcCA8kmMq8JA6k7pcAfLKtsBChmZjgtgPu6tm9iz83JUS-NEB5OFMtE4h6cmVE4BLIkww8MGw5JE11f859al6k7JGc7sQNam_G9TBIHbXGMa771Al9ZIZOTWYLw36Qs_tyXBq6DTe76m4aGpJrA2rVJlGBlGKoaw2H31Yld3KCOcwFyRzkry136aji1afNu-piKguWXpDJ9kidkD7nsfa28hAWC-vKDP19kpALbCOIelGAA_B0PyNBkoOnbLbRm3VLsXszQmfbrmb62l_OHzyvl5XDEuFklrH-FNttV1BD7WiyMelZYvBaIa3xICdAYUzDjT89FScbnqf7g7zPM4VhwrwlJcl76cwXR2j_xX_TVxt_L-09evQzvfxY1lkU12hfrZ1FXD0PkVd5bMAvbqHTo93Gido0API9ylpEb2cJrvAS1euA7hBXCFq6nnZzVpwFlyCnuF-u3Q0_WmKRXsHnDp2Z5u_mHNAGqh4O8g9fbKB3IHv5CeDtraoByib4fnGO7c6uBOdgXMorSzjLFuVUFcRsRUcx5HxtyiOwSR-0000]--></g></svg>