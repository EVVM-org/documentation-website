<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="885px" preserveAspectRatio="none" style="width:908px;height:885px;background:#FFFFFF;" version="1.1" viewBox="0 0 908 885" width="908px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="317" x="291.75" y="27.9951">confirmServiceStaking Transaction Flow</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="285" x="307.75" y="44.292">(Happy Path - Successful Execution)</text><rect fill="#FFFFFF" height="740.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="63.5" y="99.8906"/><rect fill="#FFD700" height="660.5859" style="stroke:#181818;stroke-width:1.0;" width="10" x="297.5" y="171.2891"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="675.5" y="373.3516"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="675.5" y="431.6172"/><rect fill="#00EE20" height="47.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="675.5" y="755.4766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="68" x2="68" y1="89.8906" y2="849.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="302" x2="302" y1="89.8906" y2="849.875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="680" x2="680" y1="89.8906" y2="849.875"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="5" y="58.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="12" y="78.5889">Service Contract</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="5" y="848.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="12" y="868.8701">Service Contract</text><rect fill="#FFD700" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="270" y="58.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="277" y="78.5889">Staking</text><rect fill="#FFD700" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="270" y="848.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="277" y="868.8701">Staking</text><rect fill="#00EE20" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="654" y="58.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="661" y="78.5889">EVVM</text><rect fill="#00EE20" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="654" y="848.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="661" y="868.8701">EVVM</text><rect fill="#FFFFFF" height="740.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="63.5" y="99.8906"/><rect fill="#FFD700" height="660.5859" style="stroke:#181818;stroke-width:1.0;" width="10" x="297.5" y="171.2891"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="675.5" y="373.3516"/><rect fill="#00EE20" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="675.5" y="431.6172"/><rect fill="#00EE20" height="47.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="675.5" y="755.4766"/><path d="M26,104.8906 L26,144.8906 L723,144.8906 L723,114.8906 L713,104.8906 L26,104.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M713,104.8906 L713,114.8906 L723,114.8906 L713,104.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217" x="259.5" y="121.9575">This MUST be in same transaction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="259.5" y="137.0903">as prepareServiceStaking + caPay</text><polygon fill="#181818" points="285.5,167.2891,295.5,171.2891,285.5,175.2891,289.5,171.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="73.5" x2="291.5" y1="171.2891" y2="171.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="80.5" y="166.2231">confirmServiceStaking()</text><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="200.4219" y2="200.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="200.4219" y2="213.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="213.4219" y2="213.4219"/><polygon fill="#181818" points="318.5,209.4219,308.5,213.4219,318.5,217.4219,314.5,213.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="314.5" y="195.356">onlyCA modifier check</text><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="254.1875" y2="254.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="254.1875" y2="267.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="267.1875" y2="267.1875"/><polygon fill="#181818" points="318.5,263.1875,308.5,267.1875,318.5,271.1875,314.5,267.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="314.5" y="249.1216">Verify timestamp == block.timestamp</text><path d="M573,226.4219 L573,281.4219 L777,281.4219 L777,236.4219 L767,226.4219 L573,226.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M767,226.4219 L767,236.4219 L777,236.4219 L767,226.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="579" y="243.4888">CRITICAL: Ensures all 3 steps</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="579" y="258.6216">(prepare + pay + confirm)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="579" y="273.7544">happen in same transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="319.5859" y2="319.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="319.5859" y2="332.5859"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="332.5859" y2="332.5859"/><polygon fill="#181818" points="318.5,328.5859,308.5,332.5859,318.5,336.5859,314.5,332.5859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319" x="314.5" y="314.52">Verify msg.sender == serviceStakingData.service</text><path d="M645,291.8203 L645,346.8203 L803,346.8203 L803,301.8203 L793,291.8203 L645,291.8203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M793,291.8203 L793,301.8203 L803,301.8203 L793,291.8203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="651" y="308.8872">Authentication:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="651" y="324.02">Only the service that</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="651" y="339.1528">prepared can confirm</text><polygon fill="#181818" points="663.5,369.3516,673.5,373.3516,663.5,377.3516,667.5,373.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="669.5" y1="373.3516" y2="373.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="314.5" y="368.2856">Query current service balance</text><polygon fill="#181818" points="318.5,398.4844,308.5,402.4844,318.5,406.4844,314.5,402.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="679.5" y1="402.4844" y2="402.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="324.5" y="397.4185">serviceBalanceAfter</text><polygon fill="#181818" points="663.5,427.6172,673.5,431.6172,663.5,435.6172,667.5,431.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="669.5" y1="431.6172" y2="431.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="314.5" y="426.5513">Query current staking contract balance</text><polygon fill="#181818" points="318.5,456.75,308.5,460.75,318.5,464.75,314.5,460.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="679.5" y1="460.75" y2="460.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="324.5" y="455.6841">contractBalanceAfter</text><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="505.0156" y2="505.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="505.0156" y2="518.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="518.0156" y2="518.0156"/><polygon fill="#181818" points="318.5,514.0156,308.5,518.0156,318.5,522.0156,314.5,518.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="314.5" y="484.8169">Calculate expected payment:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354" x="314.5" y="499.9497">totalRequired = amountOfStaking * PRICE_OF_STAKING</text><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="577.4141" y2="577.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="577.4141" y2="590.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="590.4141" y2="590.4141"/><polygon fill="#181818" points="318.5,586.4141,308.5,590.4141,318.5,594.4141,314.5,590.4141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="314.5" y="542.0825">Verify payment correctness:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="314.5" y="557.2153">serviceBefore - totalRequired == serviceAfter</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313" x="314.5" y="572.3481">contractBefore + totalRequired == contractAfter</text><path d="M639,534.5156 L639,589.5156 L839,589.5156 L839,544.5156 L829,534.5156 L639,534.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M829,534.5156 L829,544.5156 L839,544.5156 L829,534.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="645" y="551.5825">VALIDATION: Exact amount</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="645" y="566.7153">must have been transferred</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="645" y="581.8481">via caPay()</text><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="695.2109" y2="695.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="695.2109" y2="708.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="708.2109" y2="708.2109"/><polygon fill="#181818" points="318.5,704.2109,308.5,708.2109,318.5,712.2109,314.5,708.2109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="314.5" y="614.481">stakingBaseProcess(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="322.5" y="629.6138">AccountMetadata{service, IsAService=true},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="322.5" y="644.7466">isStaking=true,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="322.5" y="659.8794">amountOfStaking,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="322.5" y="675.0122">0, 0, 0, false, address(0), 0x0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="314.5" y="690.145">)</text><path d="M623,622.0469 L623,692.0469 L811,692.0469 L811,632.0469 L801,622.0469 L623,622.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M801,622.0469 L801,632.0469 L811,632.0469 L801,622.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="629" y="639.1138">Core staking logic:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="629" y="654.2466">- Updates staking balance</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="629" y="669.3794">- Records history</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="629" y="684.5122">- Assigns staker status</text><polygon fill="#181818" points="663.5,751.4766,673.5,755.4766,663.5,759.4766,667.5,755.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="669.5" y1="755.4766" y2="755.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="314.5" y="750.4106">pointStaker(service, 0x01)</text><path d="M690,721.2109 L690,776.2109 L901,776.2109 L901,731.2109 L891,721.2109 L690,721.2109 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M891,721.2109 L891,731.2109 L901,731.2109 L891,721.2109 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="696" y="738.2778">Grant staker status:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="696" y="753.4106">Service can now earn rewards</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="696" y="768.5435">from processing transactions</text><polygon fill="#181818" points="318.5,798.7422,308.5,802.7422,318.5,806.7422,314.5,802.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="679.5" y1="802.7422" y2="802.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="324.5" y="797.6763">Status updated</text><polygon fill="#181818" points="84.5,827.875,74.5,831.875,84.5,835.875,80.5,831.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="78.5" x2="301.5" y1="831.875" y2="831.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="90.5" y="826.8091">Staking completed successfully</text><!--SRC=[bLLHRziu37xtho2sbsPhUhdjOK2n3d3Jj1VSklQQh4y61bQc4w6ov9FajC6m_pxAbjqwbnKx841i-YFvyHD9VNH-g-XJaXjHbwGzV4y0Jb7SNrXJwtngbB7mi9QUaX_9npyYEgdGUYbaXUpnQa5s8mN1r6XlKVXNW0vSQzn1UhoNUjK2scTuVNv-zc4o6G9djxUN3Oescn9UJoQpsRj9adZf5O4mkf2sZ6bZJ5XQr8wpIwFXN9c7J1_yXLMrXMlqQnZ3eXQ2d2jg1RD74dK0Zf946qzWDcGxneTjpcDOhgM3ow-B9TmHI0qEImB_b2NJpA-onCHfXyjR47YDsoG9o0roXawE-0_ZJxq0n_iBEXWzyzxHAkaCWp16g-qqXTBaif1Sa5YJkFy5zfQiBBRWPKbiB2iuEO4xPSJzKMzgfR5ojVRiCBsPB-VJzFCnpBIhBJb0fU0zXwJAiTPH22wzmcqGeArfbEardmBfVGg-pArqgoD7EkTAc9mRY7E67eywJGSyqzglkO-bm93XEDDNh0gmhOl0p-Wp7VdcV5Aw8plW4xlWdvhi5aHjRPYEBiOTAjISkZ-XGPysB-D1JT7njFLB2qysoMdW_XlPutSH1-t_q-WyVvl7a-iKbQXL0tgiI7YMZaywx0mMsHkFweR-hMMGz0ImvEtXhufk8Dx0zSryEljsTVvjiKp_dd-vUFdiOsJcovKBhtbmEKid8XM6EsqCErdx9cdAodHVR8j_-rzyXsXr6FJHRVfvVfOkvrTVkECVWzXjJPakQ-TXZHlk0kA-Rlgv8EQPPteZiHrzdjxz1SQdKtHqRKtOI0UP1aY52D4loMFElVszNqPpbyQzSE9jJJyE0rgwA6nZQqmxYZUsoM7y5QWSny8yjo7XPCJMnqd6-syuuq6cZgeoAobOz35yhPWIFMtis7NXqmtn2UKEU5LwOxV1b3edLxf5XwtgqTTkNszNHcg_Q507VRbCwy_HB_fvmFN2Ofo8FWcJxQwYCDJQF02XrM3f0PbafWjhIjxOZUg1oxDLvFPDow892tLJV_x2d0IlcBdnYbDQLeh2dBZ-wb5y9pmB4mCaFm40]--></g></svg>